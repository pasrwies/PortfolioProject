-- Team_Home_with_Most_Goals

Select TEAM_NAME_HOME, 
	   TEAM_HOME_SCORE
FROM SOCCER.TBL_UEFA_2020
ORDER BY TEAM_HOME_SCORE DESC
lIMIT 3;


-- TEAM_WITH_MAJORITY_POSSESSION

SELECT 
	CASE WHEN POSSESSION_HOME > POSSESSION_AWAY THEN TEAM_NAME_HOME
	     WHEN POSSESSION_HOME < POSSESSION_AWAY THEN TEAM_NAME_AWAY
	     ELSE NULL
	     END AS TEAM_NAME,
	  COUNT(*) AS GAME_COUNT
FROM SOCCER.TBL_UEFA_2021
GROUP BY TEAM_NAME
ORDER BY GAME_COUNT DESC
LIMIT 1;



-- TEAM_WON_DUEL_LOST_GAME_STAGE_WISE

SELECT STAGE,
       CASE WHEN DUELS_WON_HOME > DUELS_WON_AWAY AND TEAM_HOME_SCORE < TEAM_AWAY_SCORE THEN TEAM_NAME_HOME
	        WHEN DUELS_WON_HOME < DUELS_WON_AWAY AND TEAM_AWAY_SCORE < TEAM_HOME_SCORE THEN TEAM_NAME_AWAY
	        ELSE NULL
	        END AS TEAM_LOST
FROM SOCCER.TBL_UEFA_2022
WHERE TEAM_LOST IS NOT NULL;
